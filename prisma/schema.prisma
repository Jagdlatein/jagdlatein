// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model QuizQuestion {
  id         Int      @id @default(autoincrement())
  country    String
  category   String
  topic      String
  question   String
  option_a   String
  option_b   String
  option_c   String
  option_d   String
  correct    String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model GlossaryEntry {
  id        Int      @id @default(autoincrement())
  term      String
  slug      String   @unique
  country   String?  // DE/AT/CH optional
  category  String?  // z.B. Wildkunde, Recht, Waffen
  body      String   // Markdown/Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model User {
  id        String   @id           // z.B. anon_<uuid> im Client gespeichert (localStorage)
  createdAt DateTime @default(now())
}

model QuizAttempt {
  id        String   @id @default(uuid())
  userId    String
  startedAt DateTime @default(now())
  finishedAt DateTime?
  total     Int      @default(0)
  correct   Int      @default(0)
  durationS Int      @default(0)

  user      User     @relation(fields: [userId], references: [id])
}

model QuizAnswer {
  id           String   @id @default(uuid())
  attemptId    String
  questionId   Int
  selected     String   // A|B|C|D
  correct      Boolean
  answeredAt   DateTime @default(now())

  attempt      QuizAttempt @relation(fields: [attemptId], references: [id])
}

model QuizFeedback {
  id          String   @id @default(uuid())
  questionId  Int
  userId      String?
  message     String
  createdAt   DateTime @default(now())
}
